###############################################
# .env.sample – Vorlage mit Erläuterungen     #
#
# Kopiere diese Datei zu ".env" und passe sie an.
# Sensible Werte niemals committen.            #
###############################################

## Bluesky (erforderlich)
# Basis-URL des Bluesky/ATProto-Dienstes. Standard ist bsky.social.
BLUESKY_SERVER_URL=https://bsky.social
# Handle oder E-Mail, mit der sich der Bot anmeldet.
BLUESKY_IDENTIFIER=deinname.bsky.social
# App-spezifisches Passwort aus den Bluesky-Einstellungen.
BLUESKY_APP_PASSWORD=xxxx-xxxx-xxxx-xxxx

# Vite-spezifische Variablen für den bsky-client (lokaler Backend-Port)
VITE_BLUESKY_IDENTIFIER=
VITE_BLUESKY_APP_PASSWORD=
VITE_BACKEND_PORT=3000

## Mastodon (optional)
# Wenn beide Werte gesetzt sind, werden Mastodon-Funktionen im Backend aktiviert.
#MASTODON_API_URL=https://mastodon.social
#MASTODON_ACCESS_TOKEN=dein_token

## Scheduler & Lokalisierung
# Serverseitige Zeitzone für den Scheduler (IANA-Format, z. B. Europe/Berlin).
TIME_ZONE=Europe/Berlin
# Clientseitige Defaults (nur fürs Frontend-Build via Vite; optional)
# In der Regel reicht TIME_ZONE/LOCALE serverseitig.
#VITE_TIME_ZONE=Europe/Berlin
#VITE_LOCALE=de-DE
# Optional: Cron-Ausdruck als Standard für den Scheduler (UI kann dies überschreiben).
# Standard im Code ist jede Minute: "* * * * *"
#SCHEDULE_TIME=* * * * *
# Demo-/Discard-Modus: Scheduler verwirft fällige Skeets/Threads (postet nicht)
# Werte: 1|true|yes aktiv, sonst false
SCHEDULER_DISCARD_MODE=false
# Maximale Parallelität pro Scheduler-Tick (Posts/Threads gleichzeitig verarbeiten)
SCHEDULER_CONCURRENCY=3
# Lag-Warnung: ab wie vielen Millisekunden Rückstand ein WARN-Log erzeugt wird
SCHEDULER_LAG_WARN_THRESHOLD_MS=60000
# Adaptive Retry-Verzögerung (Basis-Delay und Obergrenze in Millisekunden)
SCHEDULER_RETRY_BASE_MS=60000
SCHEDULER_RETRY_MAX_MS=600000

## Dashboard-Login (Pflicht seit v1.2)
# Benutzername für das Admin-Login des Dashboards.
AUTH_USERNAME=admin
# Salt:Hash-Kombination aus `npm run tools:hash-password`
AUTH_PASSWORD_HASH=
# Geheimnis zur Signierung der Session-Tokens (mind. 32 zufällige Zeichen).
AUTH_TOKEN_SECRET=
# Optional: Session-Laufzeit in Stunden (Default 12h). Alternativ AUTH_SESSION_TTL_SECONDS setzen.
#AUTH_SESSION_TTL_HOURS=12

## Zuverlässigkeit beim Posten (Server)
# Werden als Default in der Datenbank gespeichert und können über die UI überschrieben werden.
POST_RETRIES=4            # Max. Wiederholversuche bei Fehlern
POST_BACKOFF_MS=600       # Basis-Backoff in Millisekunden
POST_BACKOFF_MAX_MS=5000  # Maximaler Backoff in Millisekunden

## Netzwerk-Ports
# Interner Backend-Port (Container-intern). Wird auch von docker-compose genutzt.
BACKEND_INTERNAL_PORT=3000
# Host-Port-Mapping für das Backend (z. B. http://localhost:3200)
BACKEND_PORT=3200
# Host-Port für den Nginx-Frontend-Container (Dashboard)
FRONTEND_PORT=8080
# Optional: Direkter Server-Port (lokaler Start ohne Docker). Fällt sonst auf 3000 zurück.
#APP_PORT=3000

## Dashboard Polling (Fallback, wenn SSE nicht verfügbar ist)
# Hinweis: SSE ist die primäre Update-Quelle. Polling dient nur als Fallback.
# Steuerung bevorzugt serverseitig (wirksam ohne Rebuild):
#   THREAD_POLL_ACTIVE_MS, THREAD_POLL_IDLE_MS, THREAD_POLL_HIDDEN_MS, THREAD_POLL_MINIMAL_HIDDEN
#   SKEET_POLL_ACTIVE_MS,  SKEET_POLL_IDLE_MS,  SKEET_POLL_HIDDEN_MS,  SKEET_POLL_MINIMAL_HIDDEN
# Defaults (falls nicht gesetzt): active 60000ms, idle 300000ms, hidden 300000ms, minimalHidden false
#THREAD_POLL_ACTIVE_MS=60000
#THREAD_POLL_IDLE_MS=300000
#THREAD_POLL_HIDDEN_MS=300000
#THREAD_POLL_MINIMAL_HIDDEN=false
#SKEET_POLL_ACTIVE_MS=60000
#SKEET_POLL_IDLE_MS=300000
#SKEET_POLL_HIDDEN_MS=300000
#SKEET_POLL_MINIMAL_HIDDEN=false

# Optional: Build-Zeit-Variablen (Vite). Nur nötig, wenn Polling im Bundle fest verdrahtet werden soll.
#VITE_THREAD_POLL_ACTIVE_MS=60000
#VITE_THREAD_POLL_IDLE_MS=300000
#VITE_THREAD_POLL_HIDDEN_MS=300000
#VITE_THREAD_POLL_MINIMAL_HIDDEN=false
#VITE_SKEET_POLL_ACTIVE_MS=60000
#VITE_SKEET_POLL_IDLE_MS=300000
#VITE_SKEET_POLL_HIDDEN_MS=300000
#VITE_SKEET_POLL_MINIMAL_HIDDEN=false

# Backoff-Strategie für Polling (Client)
# Defaults im Code: Start 10000ms, Max 300000ms, Jitter 0.2, Heartbeat 2000ms
#POLL_BACKOFF_START_MS=10000
#POLL_BACKOFF_MAX_MS=300000
#POLL_JITTER_RATIO=0.2
#POLL_HEARTBEAT_MS=2000
#VITE_POLL_BACKOFF_START_MS=10000
#VITE_POLL_BACKOFF_MAX_MS=300000
#VITE_POLL_JITTER_RATIO=0.2
#VITE_POLL_HEARTBEAT_MS=2000

JSON_BODY_LIMIT_MB=25

# Bluesky Push-Transport (Client)
# Steuert, wie der Bluesky-Client Push-Registrierungen ausführt:
#   backend (default) -> über unser Backend (/api/bsky/notifications/*)
#   direct            -> direkt gegen Bluesky via @atproto/api (App-Passwort erforderlich)
#   auto              -> versucht zuerst direct, sonst backend
#   noop/disabled     -> keine Registrierung ausführen
#VITE_BSKY_PUSH_TRANSPORT=backend
# Konfiguration für den direkten Transport (nur nötig bei VITE_BSKY_PUSH_TRANSPORT=direct|auto):
# Standard-Service ist https://bsky.social; kann bei Bedarf überschrieben werden.
#VITE_BSKY_DIRECT_SERVICE=https://bsky.social
# Bluesky-Handle oder E-Mail für die Direktanmeldung (z. B. bot@example.bsky.social)
#VITE_BSKY_DIRECT_IDENTIFIER=
# App-spezifisches Passwort des obigen Accounts (wird ins Frontend gebündelt – nur für lokale Builds nutzen!)
#VITE_BSKY_DIRECT_APP_PASSWORD=

# Tenor (GIF Suche)
# Serverseitiger Proxy (empfohlen fürs Dashboard/Backend):
#   Setze TENOR_API_KEY, damit /api/tenor/* funktioniert (Key bleibt serverseitig verborgen).
# Clientseitig (ThreadWriter Desktop/Browser):
#   Setze VITE_TENOR_API_KEY, um die GIF-Suche direkt gegen Tenor zu aktivieren.
#   Hinweis: VITE_* Variablen sind im Client sichtbar; nur für lokale Nutzung geeignet.
#TENOR_API_KEY=dein_tenor_api_key
#VITE_TENOR_API_KEY=dein_tenor_api_key

# Engagement-Collector: Drosselung abhängig von Client-Präsenz
# Minimaler Abstand zwischen automatischen Engagement-Updates, wenn Clients aktiv sind (ms)
ENGAGEMENT_ACTIVE_MIN_MS=120000
# Minimaler Abstand im Idle-Modus (keine Clients gesehen) (ms); Empfehlung ~20 Minuten
ENGAGEMENT_IDLE_MIN_MS=1200000
# Schwelle, ab der der Server „idle“ annimmt, wenn kein Heartbeat mehr empfangen wurde (ms)
CLIENT_IDLE_THRESHOLD_MS=1200000

# Datenbank & Migrationen
# In Produktion empfehlen wir, das Schema ausschließlich per Migrationen zu verwalten
# und sequelize.sync() zu deaktivieren. Steuerung über DB_SYNC:
#   DB_SYNC=false  -> sync() wird übersprungen (empfohlen für Prod)
#   DB_SYNC=true   -> sync() wird ausgeführt (default in Dev)
# Optional: expliziten SQLite-Speicherpfad setzen (ansonsten nutzt die App ./data/bluesky_campaign_<env>.sqlite)
# Der Ordner wird bei Bedarf automatisch erstellt
#SQLITE_STORAGE=./data/app.sqlite

# Upload-/Temp-Verzeichnisse (werden bei Bedarf automatisch angelegt)
#UPLOAD_DIR=./data/uploads
#TEMP_UPLOAD_DIR=./data/temp

# Laufzeit-.env an benutzerdefiniertem Ort verwenden (z. B. bei Deployment)
#ENV_PATH=./config/.env

#DB_SYNC=false

# Hinweis zu Sicherheit & Quoting
# - Setze .env-Dateirechte restriktiv (z. B. chmod 600 .env).
# - Werte ohne Anführungszeichen eintragen; Leerzeichen vermeiden oder escapen.
